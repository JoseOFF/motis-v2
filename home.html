<!DOCTYPE html>
<html lang="es">
<head>
    <title>Inicio</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="js/sweet-alert.min.js"></script>
    <link rel="stylesheet" href="css/sweet-alert.css">
    <link rel="stylesheet" href="css/material-design-iconic-font.min.css">
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/jquery.mCustomScrollbar.css">
    <link rel="stylesheet" href="css/style.css">
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="js/jquery-1.11.2.min.js"><\/script>')</script>
    <script src="js/modernizr.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/jquery.mCustomScrollbar.concat.min.js"></script>
    <script src="js/main.js"></script>
    <script src="https://cdn.botpress.cloud/webchat/v2.4/inject.js"></script>
<script src="https://files.bpcontent.cloud/2025/05/22/22/20250522223936-92WAM02X.js"></script>
    <link rel="icon" href="assets/img/logo.png" type="image/png">
    

    <style>
        body {
  background-color: gray !important; /* O puedes usar otro tono como # */
}

   

        .social-section {
            max-width: 420px;
            margin: 30px auto;
            padding: 20px;
        }
    
        #postForm {
            background: #fff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
    
        #postForm input,
        #postForm textarea,
        #postForm button {
            width: 100%;
            font-size: 14px;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #ccc;
        }
    
        #postForm button {
            background-color: #3897f0;
            color: white;
            border: none;
            cursor: pointer;
        }
    
        #feed {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 20px;
    padding-top: 30px;
}

.post {
    width: 500px; /* Controla el ancho del post completo */
    background: white;
    border: 1px solid #ccc;
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}

.post img {
    width: 100%;
    height: auto;
    display: block;
}

.post p {
    padding: 10px;
    margin: 0;
    text-align: left;
}

    
        .post .content {
            padding: 15px;
            text-align: left;
        }
    
        .username {
            font-weight: bold;
        }
    
        .icons {
            font-size: 18px;
            margin-top: 10px;
        }
    
        .icons span {
            margin-right: 10px;
            cursor: pointer;
        }
        .post-actions {
  padding: 10px;
}

.like-btn {
  background: none;
  border: none;
  cursor: pointer;
  font-size: 18px;
  color: #e74c3c;
  margin-bottom: 10px;
}

.comment-section {
  margin-top: 10px;
}

.comment-input {
  width: 70%;
  padding: 5px;
}

.comment-btn {
  padding: 5px 10px;
  margin-left: 5px;
}

.comments-list {
  list-style: none;
  padding: 0;
  margin-top: 10px;
}

.comments-list li {
  background: #f0f0f0;
  margin-bottom: 5px;
  padding: 5px;
  border-radius: 5px;
}
.create-post {
  background-color: #fff;
  padding: 15px;
  margin: 20px auto;
  max-width: 600px;
  border-radius: 10px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}

.post-header {
  display: flex;
  align-items: flex-start;
}

.profile-pic {
  width: 50px;
  height: 50px;
  border-radius: 50%;
  margin-right: 10px;
}

#create-post textarea,
#commentInput {
  width: 100%;
  height: 80px;
  resize: none;
  padding: 10px;
  border: 1px solid #ccc;
  border-radius: 8px;
  font-family: inherit;
}

.post-footer {
  margin-top: 10px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

#photoInput {
  flex: 1;
}

.post-button {
  background-color: #f2187e;
  color: white;
  border: none;
  padding: 8px 16px;
  margin-left: 10px;
  border-radius: 5px;
  cursor: pointer;
}

.post-button:hover {
  background-color: #af1d66;
}
.upload-icon {
  cursor: pointer;
  color: #555;
  margin-right: 10px;
}

.upload-icon:hover {
  color: #1877f2;
}

.post-footer {
  display: flex;
  align-items: center;
  gap: 10px;
}


    </style>



    
</head>


<body>
    <div class="navbar-lateral full-reset">
        <div class="visible-xs font-movile-menu mobile-menu-button"></div>
        <div class="full-reset container-menu-movile nav-lateral-scroll">
            <div class="logo full-reset all-tittles">
                <i class="visible-xs zmdi zmdi-close pull-left mobile-menu-button" style="line-height: 55px; cursor: pointer; padding: 0 10px; margin-left: 7px;"></i> 
                PlayBass!
            </div>
            <div class="nav-lateral-divider full-reset"></div>
            <div class="full-reset" style="padding: 10px 0; color:#fff;">
                <figure>
                    <img src="assets/img/logo.png" alt="Biblioteca" class="img-responsive center-box" style="width:55%;">
                </figure>
                <p class="text-center" style="padding-top: 15px;">Menu de PlayBass!</p>
            </div>
            <div class="nav-lateral-divider full-reset"></div>
            <div class="full-reset nav-lateral-list-menu">
                <ul class="list-unstyled">
                    <li><a href="home.html"><i class="zmdi zmdi-home zmdi-hc-fw"></i>&nbsp;&nbsp; Inicio</a></li>
                    
                    <li>
                        <div class="dropdown-menu-button"><i class="zmdi zmdi-assignment-o zmdi-hc-fw"></i>&nbsp;&nbsp; Aprende +<i class="zmdi zmdi-chevron-down pull-right zmdi-hc-fw icon-sub-menu"></i></div>
                        <ul class="list-unstyled">
                            <li><a href="https://www.songsterr.com/"><i class="zmdi zmdi-book zmdi-hc-fw"></i>&nbsp;&nbsp; Biblioteca de canciones</a></li>
                            <li><a href="catalog.html"><i class="zmdi zmdi-bookmark-outline zmdi-hc-fw"></i>&nbsp;&nbsp; Eres nuevo en esto?</a></li>
                        </ul>
                    </li>
                    <li>
                        <div class="dropdown-menu-button"><i class="zmdi zmdi-case zmdi-hc-fw"></i>&nbsp;&nbsp; Servicios <i class="zmdi zmdi-chevron-down pull-right zmdi-hc-fw icon-sub-menu"></i></div>
                        <ul class="list-unstyled">
                            <li><a href="institution.html"><i class="zmdi zmdi-balance zmdi-hc-fw"></i>&nbsp;&nbsp; Reconocimiento de notas</a></li>
                            <li><a href="provider.html"><i class="zmdi zmdi-truck zmdi-hc-fw"></i>&nbsp;&nbsp; Simulador de bajo</a></li>
                           
                        </ul>
                    </li>
                    <li>
                        <div class="dropdown-menu-button"><i class="zmdi zmdi-account-add zmdi-hc-fw"></i>&nbsp;&nbsp; Foro y comunidad <i class="zmdi zmdi-chevron-down pull-right zmdi-hc-fw icon-sub-menu"></i></div>
                        <ul class="list-unstyled">
                            <li><a href="admin.html"><i class="zmdi zmdi-face zmdi-hc-fw"></i>&nbsp;&nbsp; Contactos</a></li>
                            <li><a href="teacher.html"><i class="zmdi zmdi-male-alt zmdi-hc-fw"></i>&nbsp;&nbsp; Nuevo docente</a></li>
                            <li><a href="student.html"><i class="zmdi zmdi-accounts zmdi-hc-fw"></i>&nbsp;&nbsp; Nuevo estudiante</a></li>
                            <li><a href="personal.html"><i class="zmdi zmdi-male-female zmdi-hc-fw"></i>&nbsp;&nbsp; Nuevo personal administrativo</a></li>
                        </ul>
                    </li>
                    <li>
                     
                    <li><a href="advancesettings.html"><i class="zmdi zmdi-wrench zmdi-hc-fw"></i>&nbsp;&nbsp; Configuraciones avanzadas</a></li>
                </ul>
            </div>
        </div>
    </div>
    <div class="content-page-container full-reset custom-scroll-containers">
        <nav class="navbar-user-top full-reset">
            <ul class="list-unstyled full-reset">
                <figure>
                   <img src="assets/img/user01.png" alt="user-picture" class="img-responsive img-circle center-box">
                </figure>


             <li style="color:#fff; cursor:default;">
  <span class="all-tittles" id="nombreUsuario">Admin Name</span>
</li>



                <li  class="tooltips-general exit-system-button" data-href="index.html" data-placement="bottom" title="Salir del sistema">
                    <i class="zmdi zmdi-power"></i>
                </li>
                <li  class="tooltips-general search-book-button" data-href="searchbook.html" data-placement="bottom" title="Buscar libro">
                    <i class="zmdi zmdi-search"></i>
                </li>
                <li  class="tooltips-general btn-help" data-placement="bottom" title="Ayuda">
                    <i class="zmdi zmdi-help-outline zmdi-hc-fw"></i>
                </li>
                <li class="mobile-menu-button visible-xs" style="float: left !important;">
                    <i class="zmdi zmdi-menu"></i>
                </li>
                <li class="desktop-menu-button hidden-xs" style="float: left !important;">
                    <i class="zmdi zmdi-swap"></i>
                </li>
            </ul>
        </nav>
        <div class="container">
            <div class="page-header">




















              <h1 class="all-tittles">PlayBass.Net! <small></small></h1>
            </div>
        </div>
        <section class="full-reset text-center" style="padding: 40px 0;">
            <form id="postForm" class="create-post">
                <div class="post-header">
                  <textarea id="commentInput" placeholder="¿En qué estás pensando?" required></textarea>
                </div>
                <div class="post-footer">
                  <!-- Ícono para subir imagen -->
                 <!-- Ícono para subir imagen (solo se verá el ícono, no el input file) -->
                 <label for="photoInput" class="upload-icon">
                    <i class="zmdi zmdi-camera-add zmdi-hc-2x"></i>
                  </label>
                  <input type="file" id="photoInput" accept="image/*" required style="display: none;">
                  

                  
                  
                  <!-- Botón de publicar -->
                  <button type="submit" class="post-button">Publicar</button>
                </div>
              </form>
              
              
        <div id="feed"></div>
          <script src="https://cdn.botpress.cloud/webchat/v2.4/inject.js"></script>
  <script src="https://files.bpcontent.cloud/2025/05/22/22/20250522223936-92WAM02X.js"></script>


       <script type="module">
  import { supabaseCliente } from './supabase-init.js';

  const user = JSON.parse(localStorage.getItem("usuario"));
  if (!user) {
    window.location.href = "sesion.html";
  }

  document.getElementById('postForm').addEventListener('submit', async function (e) {
    e.preventDefault();

    const file = document.getElementById('photoInput').files[0];
    const comment = document.getElementById('commentInput').value.trim();

    if (!file || !comment) return;

    const fileName = `${Date.now()}_${file.name}`; // No usamos user.id porque no hay user_id

    // 1. Subir imagen al storage
    const { data: storageData, error: storageError } = await supabaseCliente.storage
      .from('posts') // nombre del bucket en Supabase Storage
      .upload(fileName, file);

    if (storageError) {
      console.error("Error al subir imagen:", storageError.message);
      return;
    }

    // 2. Obtener la URL pública
    const { data: publicUrlData } = supabaseCliente
      .storage
      .from('posts')
      .getPublicUrl(fileName);

    const imageUrl = publicUrlData.publicUrl;

    // 3. Insertar post en la base de datos
    const { error: insertError } = await supabaseCliente
      .from('posts')
      .insert([{
        comment: comment,        // 👈 campo correcto
        image_url: imageUrl      // 👈 campo correcto
      }]);

    if (insertError) {
      console.error("Error al guardar post:", insertError.message);
      return;
    }

    document.getElementById('commentInput').value = '';
    document.getElementById('photoInput').value = '';

    await displayPosts();
  });

  async function displayPosts() {
    const feed = document.getElementById('feed');
    feed.innerHTML = '';

    const { data: posts, error } = await supabaseCliente
      .from('posts')
      .select('*')
      .order('created_at', { ascending: false });

    if (error) {
      console.error("Error al cargar posts:", error.message);
      return;
    }

    posts.forEach(post => {
      const div = document.createElement('div');
      div.className = "post";
      div.innerHTML = `
        <img src="${post.image_url}" alt="Imagen del post">
        <p>${post.comment}</p>
        <div class="post-actions">
          <button class="like-btn">❤️ <span class="like-count">0</span></button>
          <div class="comment-section">
            <input type="text" class="comment-input" placeholder="Escribe un comentario...">
            <button class="comment-btn">Comentar</button>
            <ul class="comments-list"></ul>
          </div>
        </div>
      `;

      // Likes (temporales en local)
      const likeBtn = div.querySelector('.like-btn');
      const likeCount = div.querySelector('.like-count');
      let count = 0;
      likeBtn.addEventListener('click', () => {
        count++;
        likeCount.textContent = count;
      });

      // Comentarios (temporales en local)
      const commentBtn = div.querySelector('.comment-btn');
      const commentInput = div.querySelector('.comment-input');
      const commentsList = div.querySelector('.comments-list');

      commentBtn.addEventListener('click', () => {
        const text = commentInput.value.trim();
        if (text !== "") {
          const li = document.createElement('li');
          li.textContent = text;
          commentsList.appendChild(li);
          commentInput.value = "";
        }
      });

      feed.appendChild(div);
    });
  }

  // Mostrar posts al cargar
  displayPosts();




           
  document.addEventListener('DOMContentLoaded', () => {
    window.botpressWebChat.init({
      host: 'https://cdn.botpress.cloud/webchat',
      botId: '92WAM02X',
      botName: 'Mi Botpress',
      locale: 'es',
      showCloseButton: true
    });
  });
            </script>


            
            
            
        </section>
        <div class="modal fade" tabindex="-1" role="dialog" id="ModalHelp">
          <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title text-center all-tittles">ayuda del sistema</h4>
                </div>
                <div class="modal-body">
                    Lorem ipsum dolor sit amet, consectetur adipisicing elit. Inventore dignissimos qui molestias ipsum officiis unde aliquid consequatur, accusamus delectus asperiores sunt. Quibusdam veniam ipsa accusamus error. Animi mollitia corporis iusto.
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-dismiss="modal"><i class="zmdi zmdi-thumb-up"></i> &nbsp; De acuerdo</button>
                </div>
            </div>
          </div>
        </div>
        <footer class="footer full-reset">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-xs-12 col-sm-6">
                        <h4 class="all-tittles">Acerca de</h4>
                        <p>
                            PlayBass es una plataforma para aprender y practicar el bajo eléctrico. Ofrece herramientas interactivas, una biblioteca de canciones y una comunidad donde puedes compartir tu progreso y conectar con otros músicos.
                        </p>
                    </div>
                    <div class="col-xs-12 col-sm-6">
                        <h4 class="all-tittles">Desarrollador</h4>
                        <ul class="list-unstyled">
                            <li><i class="zmdi zmdi-check zmdi-hc-fw"></i>&nbsp; © Team Wicho<i class="zmdi zmdi-facebook zmdi-hc-fw footer-social"></i><i class="zmdi zmdi-twitter zmdi-hc-fw footer-social"></i></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="footer-copyright full-reset all-tittles">© Team Wicho</div>
        </footer>
    </div>



    <!-- SECCIÓN DE MENSAJES PRIVADOS -->
<div class="private-messages-container">
  <h3>Mensajes privados</h3>
  <div id="chatUsersList" class="chat-users-list"></div>

  <div id="chatWindow" class="chat-window" style="display:none;">
    <h4 id="chatWith"></h4>
    <div id="chatMessages" class="chat-messages"></div>
    <input type="text" id="chatInput" placeholder="Escribe un mensaje...">
    <button id="sendMessageBtn">Enviar</button>
  </div>
</div>



    <script type="module">
  document.addEventListener('DOMContentLoaded', () => {
    const usuario = JSON.parse(localStorage.getItem('usuario'));
    if (!usuario) {
      window.location.href = 'index.html';
      return;
    }

    // Solo modificar el nombre del usuario, no todos los all-tittles
    const nombreElem = document.getElementById('nombreUsuario');
    if (nombreElem) {
      nombreElem.textContent = usuario.nombre_usuario || 'Usuario';
    }

    // Botón de cerrar sesión
    const logoutBtn = document.querySelector('.exit-system-button');
    if (logoutBtn) {
      logoutBtn.addEventListener('click', () => {
        localStorage.removeItem('usuario');
        window.location.href = 'index.html';
      });
    }
  });
</script>


<!-- Al final del body de home.html -->
<script type="module">
  import { iniciarChat } from './mensajes.js';
  iniciarChat();
</script>

    
</body>


</html>